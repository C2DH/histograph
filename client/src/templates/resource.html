<div style="position: relative; width: 50%"><div class="container-fluid">
  <div class="row">
    <div class="col-md-8">
      <div ng-if="item" class="resource item">
        <h3><a ng-href="#/r/{{item.id}}">{{item.props.title || item.props.name }}</a></h3>
        {{item.props|guessInterval}}
        <div class="tags locations">
          <span ng-repeat="location in item.locations">
            <a ng-if="location.geocode_id" class="tag location" >{{location.geocode_formatted_address}}</a>
            <a ng-if="location.geonames_id" class="tag location" >{{location.geonames_toponymName}}, {{location.geonames_countryName}}</a>
            <span ng-if="!$last">-</span>
          </span>
          <!-- collect comments about places -->
        </div>
    
        <div class="tags">
          <span ng-repeat="per in item.persons" class='tag person'>{{per.name}}</span>
        </div>

        <div ng-if="currentAnnotation">
          <div class="caption" annotator marked="currentAnnotation.annotations.caption" ></div>
          <div class="source" annotator marked="currentAnnotation.annotations.source" ></div>  
        </div>

        <!-- Single button -->
        <div ng-if='item.props.mimetype=="image"'>
          <div class="btn-group" dropdown is-open="status.isopen" tooltip="view a different version">
            <button type="button" class="btn btn-default dropdown-toggle" dropdown-toggle ng-disabled="disabled">
              {{currentVersion.service || "accepted"}}<span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <li ng-repeat="version in item.versions"><a ng-click="switchVersion(version)">{{version.service || "first version"}}</a>

              <li class="divider"></li>

              <li><a ng-click="switchVersion(mergedVersion)">merged version</a></li>
            </ul>
          </div>
          <div>
            <img  ng-src="media/{{item.props.url}}" annotorious w="item.props.width" h="item.props.height" version="currentVersion">
          </div>
        </div>
        <blockquote>
         {{item.props.stakeholders||item.props.caption}}
        </blockquote>
    
        <div class="discussion">
          <div class="comment" ng-repeat="com in item.comments">
            <span cmlass="username">{{com.user.username}}</span> <span class="date">{{com.comment.creation_date}}</span> â€” {{com.comment.content}}</div>
          <a class="btn btn-default btn-block" ng-click="startMention(item)">join discussion</a>
          
        </div>
        <div id="inquirer" class="{{commenting? 'commenting': ''}}">
          <div>
            <img class="user-picture" ng-src='{{user.picture}}'>
            {{user.username}} {{comment.tag}}
          </div>
          <div ng-model='comment.text' ui-codemirror="{
              lineNumbers: false,
              theme:'twilight',
              lineWrapping : true,
              mode: 'Smalltalk'
            }">
          </div>
          <button class="btn btn-default" ng-click="postMention(item)">comment</button>
        </div> 
      </div>
    </div>
    <div class="col-md-4">
      <div class="see-also">
        <div class="related" ng-repeat="relatedItem in related">
          <h4><a ng-href="#/r/{{relatedItem.id}}">{{relatedItem.props.title || relatedItem.props.name }}</a></h4>
          {{relatedItem.props|guessInterval}} ({{item.props|guessDifference:relatedItem.props}})
          
          <div class="tags locations">
            <span ng-repeat="location in relatedItem.locations">

              <a ng-if="location.geocode_id" class="tag location" >{{location.geocode_formatted_address}}</a>

              <a ng-if="location.geonames_id" class="tag location" >{{location.geonames_toponymName}}, {{location.geonames_countryName}}</a> <span ng-if="!$last">-</span> 
            <!-- collect comments about places -->
          </div>
          
          <div class="tags">
            <span ng-repeat="per in relatedItem.persons" class='tag person'>{{per.name}}</span>
          </div>

          <img  ng-if='relatedItem.props.mimetype=="image"' ng-src="media/{{relatedItem.props.url}}" >
          <blockquote>
           {{relatedItem.props.stakeholders || relatedItem.props.caption}}
          </blockquote>
        </div>
      </div>
    </div>
    
  </div>
</div>
</div>


